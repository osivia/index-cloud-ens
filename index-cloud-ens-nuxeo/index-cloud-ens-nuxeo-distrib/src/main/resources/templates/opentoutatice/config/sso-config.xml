<component name="fr.index.cloud.ens.nuxeo.sso.config">

	<!-- <require>org.nuxeo.ecm.platform.ui.web.auth.defaultConfig</require> 
		<require>org.nuxeo.ecm.platform.login.Cas2SSO</require> <require>org.nuxeo.ecm.platform.login.Portal</require> 
		<require>org.nuxeo.ecm.automation.server.auth.config</require> <require>org.nuxeo.ecm.platform.oauth.auth.defaultConfig</require> -->
	<require>org.nuxeo.ecm.platform.ui.web.auth.WebEngineConfig</require>
	<require>org.nuxeo.ecm.platform.login.Portal</require>

   <!-- Include Portal SSO Auth into authentication chain -->
  <extension target="org.nuxeo.ecm.platform.ui.web.auth.service.PluggableAuthenticationService"
      point="specificChains">

    <specificAuthenticationChain name="Automation">
        <urlPatterns>
            <url>(.*)/automation.*</url>
        </urlPatterns>

        <replacementChain>
            <plugin>AUTOMATION_BASIC_AUTH</plugin>
            <plugin>PORTAL_AUTH</plugin>
        </replacementChain>
    </specificAuthenticationChain>
  </extension>



	<!-- Configure you CAS server parameters -->
	<extension
		target="org.nuxeo.ecm.platform.ui.web.auth.service.PluggableAuthenticationService"
		point="authenticators">


		<authenticationPlugin name="PORTAL_AUTH">
			<loginModulePlugin>Trusting_LM</loginModulePlugin>
			<parameters>
				<parameter name="secret">${nuxeo.auth.secret.key}</parameter>
				<parameter name="maxAge">${nuxeo.auth.max.age}</parameter>
				<parameter name="digestAlgorithm">MD5</parameter>
			</parameters>
		</authenticationPlugin>
	</extension>

</component>
