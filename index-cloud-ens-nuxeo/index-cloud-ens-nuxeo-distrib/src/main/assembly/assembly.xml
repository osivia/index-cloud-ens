<assembly
	xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 http://maven.apache.org/xsd/assembly-1.1.2.xsd">
	<id>bin</id>
	<formats>
		<format>zip</format>
	</formats>
	<includeBaseDirectory>false</includeBaseDirectory>

	<dependencySets>

		<dependencySet>
			<outputDirectory>/${artifactId}-${project.version}/nxserver/plugins
			</outputDirectory>
			<unpack>false</unpack>
			<scope>runtime</scope>
			<includes>
				<!-- Custom cloud-ens -->
				<include>${parent.groupId}:index-cloud-ens-nuxeo-custom:jar:${parent.version}</include>
				<!-- Opentoutatice -->
				<include>fr.opentoutatice.platform:opentoutatice-core-type-enricher:jar:${opentoutatice.version}</include>
				<include>fr.opentoutatice.platform:opentoutatice-ecm-platform-core:jar:${opentoutatice.version}</include>
				<include>fr.opentoutatice.platform:opentoutatice-addon-elasticsearch:jar:${opentoutatice.version}</include>								
				<include>fr.opentoutatice.platform:opentoutatice-addon-elasticsearch-customizer:jar:${opentoutatice.version}</include>
				<include>fr.opentoutatice.platform:opentoutatice-addon-procedures:jar:${opentoutatice.version}</include>				
			</includes>
		</dependencySet>

		<dependencySet>
			<outputDirectory>/${artifactId}-${project.version}/nxserver/bundles
			</outputDirectory>
			<unpack>false</unpack>
			<scope>runtime</scope>
			<includes>
				<!-- Login & SSO -->
				<include>org.nuxeo.ecm.platform:nuxeo-platform-login-portal-sso:jar:${nuxeo.version}</include>
				<!-- Nuxeo drive -->
				<include>org.nuxeo.ecm:nuxeo-drive-core:jar:${nuxeo.version}</include>
				<include>org.nuxeo.ecm:nuxeo-drive-operations:jar:${nuxeo.version}</include>
				<include>org.nuxeo.ecm:nuxeo-drive-jsf:jar:${nuxeo.version}</include>
				<include>org.nuxeo.ecm:nuxeo-drive-elasticsearch:jar:${nuxeo.version}</include>
			</includes>
		</dependencySet>

<!-- 
		<dependencySet>
			<outputDirectory>/${artifactId}-${project.version}/nxserver/lib
			</outputDirectory>
			<unpack>false</unpack>
			<scope>runtime</scope>
			<includes>

			</includes>
		</dependencySet>
		 -->
	</dependencySets>


	<fileSets>
		<!-- Socle -->
		<fileSet>
			<outputDirectory>/${artifactId}-${project.version}
			</outputDirectory>
			<directory>target/nuxeo-distrib/nuxeo-server-tomcat-${nuxeo.version}
			</directory>
			<includes>
				<include>**</include>
			</includes>

			<!-- Surcharges -->
			<excludes>
				<exclude>lib/log4j2.xml</exclude>
				<exclude>templates/common/config/blacklist.nxftl</exclude>
				<exclude>templates/ommon-base/nxserver/config/elasticsearch-doc-mapping.json</exclude>
			</excludes> 
		</fileSet>
		
		<!-- JDF -->
		<fileSet>
			<outputDirectory>/${artifactId}-${project.version}/nxserver
			</outputDirectory>
			<directory>target/nuxeo-mp-jsf/install
			</directory>
			<includes>
				<include>**</include>
			</includes>
		</fileSet>		

		<!-- Templates -->
		<fileSet>
			<outputDirectory>/${artifactId}-${project.version}</outputDirectory>
			<directory>src/main/resources</directory>
		</fileSet>

	</fileSets>

</assembly>
