<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Client Authentication Example</title>
<link type="text/css" rel="stylesheet"
	href="webjars/bootstrap/3.0.3/css/bootstrap.min.css" />
<script type='text/javascript'
	src='/osivia-portal-custom-web-assets/components/jquery/jquery-1.12.4.min.js'></script>
<script type='text/javascript'
	src='/osivia-portal-custom-web-assets/js/jquery-integration.min.js'></script>
<script type='text/javascript'
	src='/osivia-portal-custom-web-assets/components/jquery-ui/jquery-ui-1.11.3.min.js'></script>
<link rel='stylesheet'
	href='/osivia-portal-custom-web-assets/components/jquery-ui/jquery-ui-1.11.3.min.css'>
<script type='text/javascript'
	src='/osivia-portal-custom-web-assets/components/jquery-mobile/jquery.mobile.custom.min.js'></script>
<script
	src='/osivia-portal-custom-web-assets/components/postmessage/postmessage.min.js'></script>
<link rel='stylesheet'
	href='/osivia-portal-custom-web-assets/css/bootstrap.min.css'
	title='Bootstrap'>
<link rel='stylesheet'
	href='/osivia-portal-custom-web-assets/css/osivia.min.css'>
<script
	src='/osivia-portal-custom-web-assets/components/bootstrap/js/bootstrap.min.js'></script>
<link rel='stylesheet'
	href='/osivia-portal-custom-web-assets/components/fancybox/jquery.fancybox.min.css'>



<script>
	function authenticate() {
		var appID = "my-less-trusted-client";
		var path = '../oauth/authorize?';
		var queryParams = [ 'client_id=' + appID,
				'redirect_uri=' + window.location, 'scope=trust',
				'response_type=token' ];
		var query = queryParams.join('&');
		var url = path + query;
		window.open(url);
	}
	function display() {
		var hash = window.location.hash;
		var accessToken = hash.split('&')[0].split("=")[1];
		console.log('access-token:' + accessToken);
		var headers = {
			'Authorization' : 'Bearer ' + accessToken,
			'Accept' : 'application/json'
		};
		$JQry.ajaxSetup({
			'headers' : headers,
			dataType : 'text'
		});
		$JQry.get('../photos/user/message', function(data) {
			console.log('data:' + data);
			$JQry('#message').text(data);
		});
	}
	$JQry(function() {
		if (window.location.hash.length == 0) {
			authenticate();
		} else {
			display();
		}
	})
</script>
</head>
<body>
	<h1>Sparklr Client Authentication Sample</h1>

	<div id="content">
		<p>Once you have authenticated and approved the access, some
			JavaScript in this page will render a message from Sparklr below</p>
		<p id="message" />
	</div>
</body>
</html>
